<?php
$plugins = [
	'WooPayments'                                             => 'https://woo.com/products/woopayments',
	'Stripe'                                                  => 'https://woo.com/products/stripe',
	'WooCommerce Google Analytics'                            => 'https://woo.com/products/woocommerce-google-analytics/',
	'WooCommerce Tax'                                         => 'https://woo.com/products/tax/',
	'Facebook for WooCommerce'                                => 'https://woo.com/products/facebook/',
	'Woo Subscriptions'                                       => 'https://woo.com/products/woocommerce-subscriptions/',
	'Square'                                                  => 'https://woo.com/products/square/',
	'Product Add-Ons'                                         => 'https://woo.com/products/product-add-ons',
	'Product Bundles'                                         => 'https://woo.com/products/product-bundles/',
	'Shipment Tracking'                                       => 'https://woo.com/products/shipment-tracking/',
	'WooCommerce Shipping'                                    => 'https://woo.com/products/shipping/',
	'Min/Max Quantities'                                      => 'https://woo.com/products/minmax-quantities/',
	'WooCommerce Bookings'                                    => 'https://woo.com/products/woocommerce-bookings',
	'PayPal Braintree'                                        => 'https://woo.com/products/woocommerce-gateway-paypal-powered-by-braintree/',
	'Gift Cards'                                              => 'https://woo.com/products/gift-cards/',
	'AutomateWoo'                                             => 'https://woo.com/products/automatewoo/',
	'WooCommerce Brands'                                      => 'https://woo.com/products/brands/',
	'UPS Shipping Method'                                     => 'https://woo.com/products/ups-shipping-method/',
	'USPS Shipping Method'                                    => 'https://woo.com/products/usps-shipping-method/',
	'Checkout Field Editor'                                   => 'https://woo.com/products/woocommerce-checkout-field-editor/',
	'Product Recommendations'                                 => 'https://woo.com/products/product-recommendations/',
	'WooCommerce Purchase Order Gateway'                      => 'https://woo.com/products/woocommerce-gateway-purchase-order/',
	'ShipStation for WooCommerce'                             => 'https://woo.com/products/shipstation-integration/',
	'WooCommerce Block'                                       => 'https://woo.com/products/woocommerce-gutenberg-products-block/',
	'Table Rate Shipping'                                     => 'https://woo.com/products/table-rate-shipping/',
	'FedEx Shipping Method'                                   => 'https://woo.com/products/fedex-shipping-module/',
	'WooCommerce Additional Variation Images'                 => 'https://woo.com/products/woocommerce-additional-variation-images/',
	'Pinterest for WooCommerce'                               => 'https://woo.com/products/pinterest-for-woocommerce/',
	'EU VAT Number'                                           => 'https://woo.com/products/eu-vat-number/',
	'Back In Stock Notifications'                             => 'https://woo.com/products/back-in-stock-notifications/',
	'Product Vendors'                                         => 'https://woo.com/products/product-vendors/',
	'WooCommerce Points and Rewards'                          => 'https://woo.com/products/woocommerce-points-and-rewards/',
	'Product CSV Import Suite'                                => 'https://woo.com/products/product-csv-import-suite/',
	'Australia Post Shipping Method'                          => 'https://woo.com/products/australia-post-shipping-method/',
	'WooCommerce One Page Checkout'                           => 'https://woo.com/products/woocommerce-one-page-checkout/',
	'Canada Post Shipping Method'                             => 'https://woo.com/products/canada-post-shipping-method/',
	'WooCommerce Pre-Orders'                                  => 'https://woo.com/products/woocommerce-pre-orders/',
	'Royal Mail'                                              => 'https://woo.com/products/royal-mail/',
	'WooCommerce Accommodation Bookings'                      => 'https://woo.com/products/woocommerce-accommodation-bookings/',
	'Composite Products'                                      => 'https://woo.com/products/composite-products/',
	'WooCommerce Deposits'                                    => 'https://woo.com/products/woocommerce-deposits/',
	'Xero'                                                    => 'https://woo.com/products/xero/',
	'WooCommerce Box Office'                                  => 'https://woo.com/products/woocommerce-box-office/',
	'Conditional Shipping and Payments'                       => 'https://woo.com/products/conditional-shipping-and-payments/',
	'Payfast Payment Gateway'                                 => 'https://woo.com/products/payfast-payment-gateway/',
	'WooCommerce Bookings Availability'                       => 'https://woo.com/products/bookings-availability/',
	'Returns and Warranty Requests'                           => 'https://woo.com/products/warranty-requests/',
	'Advanced Notification'                                   => 'https://woo.com/products/advanced-notifications/',
	'All Products for Woo Subscriptions'                      => 'https://woo.com/products/all-products-for-woocommerce-subscriptions/',
	'Affirm Payments'                                         => 'https://woo.com/products/woocommerce-gateway-affirm/',
	'Shipping Multiple Addresses'                             => 'https://woo.com/products/shipping-multiple-addresses/',
	'WooCommerce Order Barcodes'                              => 'https://woo.com/products/woocommerce-order-barcodes/',
	'Eway'                                                    => 'https://woo.com/products/eway/',
	'Bulk Stock Management'                                   => 'https://woo.com/products/bulk-stock-management/',
	'Woo Subscription Downloads'                              => 'https://woo.com/products/woocommerce-subscription-downloads/',
	'Per Product Shipping'                                    => 'https://woo.com/products/per-product-shipping/',
	'AutomateWoo – Refer A Friend add-on'                     => 'https://woo.com/products/automatewoo-refer-a-friend/',
	'GoCardless'                                              => 'https://woo.com/products/gocardless/',
	'WooCommerce Distance Rate Shipping'                      => 'https://woo.com/products/woocommerce-distance-rate-shipping/',
	'WooCommerce Stamps.com API'                              => 'https://woo.com/products/woocommerce-shipping-stamps/',
	'Gifting for Woo Subscriptions'                           => 'https://woo.com/products/woocommerce-subscriptions-gifting/',
	'AutomateWoo – Birthdays add-on'                          => 'https://woo.com/products/automatewoo-birthdays/',
	'Flat Rate Box Shipping'                                  => 'https://woo.com/products/flat-rate-box-shipping/',
	'WooCommerce Coupon Campaigns'                            => 'https://woo.com/products/woocommerce-coupon-campaigns/',
	'WooCommerce Beta Tester'                                 => 'https://woo.com/products/woocommerce-beta-tester/',
	'WooCommerce'                                             => 'https://woo.com/products/woocommerce/',
	'MailPoet – Newsletters, Email Marketing, and Automation' => 'https://woo.com/products/mailpoet/',
	'Google Listings & Ads'                                   => 'https://woo.com/products/google-listings-and-ads/',
	'Sensei Pro (WC Paid Courses)'                            => 'https://woo.com/products/woocommerce-paid-courses/',
	'Sensei Pr'                                               => 'https://woo.com/products/sensei-pro/',
];

foreach ( $plugins as $name => $url ) {
	$slug = substr( $url, strrpos( trim( $url, '/' ), '/' ) + 1, - 1 );

	$cache = __DIR__ . "/cache/woocom-$slug.json";

	if ( ! file_exists( $cache ) ) {
		sleep( 1 );
		$response = file_get_contents( "https://woo.com/products/$slug" );
		if ( ! $response ) {
			throw new \RuntimeException( "Could not get plugin info for $slug" );
		}
		if ( ! file_put_contents( $cache, $response ) ) {
			throw new \RuntimeException( "Could not write plugin info for $slug" );
		}
	} else {
		$response = file_get_contents( $cache );
	}

	$response = json_decode( $response, true );
	$rating   = number_format( $response['rating'] / 20, 1, '.' );

	echo $slug . ' ' . $rating . PHP_EOL;
}